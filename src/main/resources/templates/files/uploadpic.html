<html xmlns:th="http://www.thymeleaf.org">


<head>

    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

    <title>导入Excel表</title>

    <link th:href="@{/css/bootstrap.min.css}" rel="stylesheet"/>
    <link th:href="@{/font-awesome/css/font-awesome.css}" rel="stylesheet"/>
    <link th:href="@{/css/plugins/iCheck/custom.css}" rel="stylesheet"/>
    <link th:href="@{/css/animate.css}" rel="stylesheet"/>
    <link th:href="@{/css/style.css}" rel="stylesheet"/>

</head>


<body class="gray-bg">
<div>


    <div id = "result"></div>
    <form class="form-horizontal" id="form_table" action="console/picupload" th:action="@{/console/picupload}"  method="post"  enctype="multipart/form-data">
    <input id="pic" type="file" name = 'pic' accept = "image/*" onchange = "selectFile()"/>
     <button onclick = "handIn()">提交</button>
    </form>

    <script type="text/javascript">
        var form = new FormData();//通过HTML表单创建FormData对象
//        var url = '127.0.0.1:8080/'
        function selectFile(){
            var files = document.getElementById('pic').files;
            console.log(files[0]);
            if(files.length == 0){
                return;
            }
            var file = files[0];
            var size = file.size;
            if(size >= 1*1024*1024){
                alert('文件大于1兆不行!');
                return false;
            }

            if(file.type !== 'image/jpeg' && file.type !== 'image/png' && file.type !== 'image/gif') {
                alert('不是有效的图片文件!');
                return;
            }

            //把上传的图片显示出来
            var reader = new FileReader();
            // 将文件以Data URL形式进行读入页面
            console.log(reader);
            reader.readAsBinaryString(file);
            reader.onload = function(f){
                var result = document.getElementById("result");
                var src = "data:" + file.type + ";base64," + window.btoa(this.result);
                result.innerHTML = '<img src ="'+src+'"/>';
            }
            console.log('file',file);
            ///////////////////
            form.append('file',file);
            console.log(form.get('file'));
        }

    </script>



    <style type="text/css">
        #test-image-preview {
            　　border: 1px solid #ccc;
            width: 100%;
            height: 200px;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center center;
        }
    </style>


    <!-- Mainly scripts -->
    <script src="/js/jquery-2.1.1.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <!-- iCheck -->
    <script src="/js/plugins/iCheck/icheck.min.js"></script>
    <script>
        $(document).ready(function(){
            $('.i-checks').iCheck({
                checkboxClass: 'icheckbox_square-green',
                radioClass: 'iradio_square-green',
            });
        });
    </script>




    <!--<script src="http://cdn.loveqiao.com/jquery.js"></script>-->
    <!--<script type="text/javascript">-->
        <!--var-->
            <!--fileInput = document.getElementById('test-image-file'),-->
            <!--info = document.getElementById('test-file-info'),-->
            <!--preview = document.getElementById('test-image-preview');-->
        <!--var form = new FormData();//通过HTML表单创建FormData对象-->
        <!--var url = '127.0.0.1:8080/'-->
        <!--// 监听change事件:-->
        <!--fileInput.addEventListener('change', function() {-->
            <!--// 清除背景图片:-->
            <!--preview.style.backgroundImage = '';-->
            <!--// 检查文件是否选择:-->
            <!--if(!fileInput.value) {-->
                <!--info.innerHTML = '没有选择文件';-->
                <!--return;-->
            <!--}-->
            <!--// 获取File引用:-->
            <!--var file = fileInput.files[0];-->
            <!--//判断文件大小-->
            <!--var size = file.size;-->
            <!--if(size >= 1*1024*1024){-->
                <!--alert('文件大于1兆不行!');-->
                <!--return false;-->
            <!--}-->
            <!--// 获取File信息:-->
            <!--info.innerHTML = '文件: ' + file.name + '<br>' +-->
                <!--'大小: ' + file.size + '<br>' +-->
                <!--'修改: ' + file.lastModifiedDate;-->
            <!--if(file.type !== 'image/jpeg' && file.type !== 'image/png' && file.type !== 'image/gif') {-->
                    <!--alert('不是有效的图片文件!');-->
                    <!--return;-->

                <!--// 读取文件:-->
                <!--var reader = new FileReader();-->
                <!--reader.onload = function(e) {-->
                    <!--var result = info-->
                    <!--var src = "data:" + file.type + ";base64," + window.btoa(this.result);-->
                    <!--result.innerHTML = '<img src ="'+src+'"/>';-->
<!--//                    var-->
<!--//                        data = e.target.result; // 'data:image/jpeg;base64,/9j/4AAQSk...(base64编码)...}'-->
<!--//                    preview.style.backgroundImage = 'url(' + data + ')';-->
                <!--};-->
                <!--// 以DataURL的形式读取文件:-->
<!--//                reader.readAsDataURL(file);-->
                <!--reader.readAsBinaryString(file)-->
                <!--form.append('file',file);-->
                <!--console.log(form.get('file'));-->
                <!--console.log(file);-->
            <!--}});-->
    <!--</script>-->

</div>
</body>
</html>
